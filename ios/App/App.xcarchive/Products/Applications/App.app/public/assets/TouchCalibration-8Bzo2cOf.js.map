{"version":3,"file":"TouchCalibration-8Bzo2cOf.js","sources":["../../src/components/TouchCalibration.jsx"],"sourcesContent":["import { useState } from 'react';\n\nconst TouchCalibration = ({ onComplete }) => {\n    // 0: Start, 1: XL Test (for 2x2), 2: Large Test (for 3x3), 3: Medium Test (for 4x4), 4: Small Test (for 5x5/6x6), 5: Result\n    const [phase, setPhase] = useState(0);\n    const [results, setResults] = useState({ xl: 0, large: 0, medium: 0, small: 0 });\n    const [attempts, setAttempts] = useState(0); // Count attempts per phase\n    const [targetPos, setTargetPos] = useState({ x: 50, y: 50 }); // Center by default\n\n    const MAX_ATTEMPTS = 3;\n\n    const getRandomPos = () => {\n        // Avoid edges (15% to 85%)\n        return {\n            x: 15 + Math.random() * 70,\n            y: 15 + Math.random() * 70\n        };\n    };\n\n    const handleTap = (success) => {\n        if (phase === 0) {\n            setPhase(1); // Start XL Test\n            setTargetPos(getRandomPos());\n            return;\n        }\n\n        const currentKey = phase === 1 ? 'xl' : phase === 2 ? 'large' : phase === 3 ? 'medium' : 'small';\n\n        if (success) {\n            setResults(prev => ({ ...prev, [currentKey]: prev[currentKey] + 1 }));\n        }\n\n        const nextAttempt = attempts + 1;\n\n        if (nextAttempt >= MAX_ATTEMPTS) {\n            const finalSuccessCount = results[currentKey] + (success ? 1 : 0);\n            \n            // End of this phase logic\n            if (phase === 1) {\n                // If they failed XL (<=1 success), stop here.\n                if (finalSuccessCount <= 1) {\n                    finishCalibration('super-big');\n                } else {\n                    setPhase(2);\n                    setAttempts(0);\n                    setTargetPos(getRandomPos());\n                }\n            } else if (phase === 2) {\n                // If they failed Large, set to Big (3x3)\n                if (finalSuccessCount <= 1) {\n                    finishCalibration('big');\n                } else {\n                    setPhase(3);\n                    setAttempts(0);\n                    setTargetPos(getRandomPos());\n                }\n            } else if (phase === 3) {\n                // If they failed Medium, set to Standard (4x4)\n                if (finalSuccessCount <= 1) {\n                    finishCalibration('standard');\n                } else {\n                    setPhase(4);\n                    setAttempts(0);\n                    setTargetPos(getRandomPos());\n                }\n            } else if (phase === 4) {\n                // If they passed Small\n                if (finalSuccessCount >= 2) {\n                    finishCalibration('dense');\n                } else {\n                    finishCalibration('medium');\n                }\n            }\n        } else {\n            setAttempts(nextAttempt);\n            setTargetPos(getRandomPos());\n        }\n    };\n\n    const finishCalibration = (size) => {\n        localStorage.setItem('kiwi-grid-size', size);\n        onComplete();\n    };\n\n    const getButtonSize = () => {\n        if (phase === 1) return 10;    // 160px (Test for XL ability)\n        if (phase === 2) return 7.5;   // 120px (Test for Large ability)\n        if (phase === 3) return 5.5;   // 88px  (Test for Medium ability)\n        if (phase === 4) return 4.25;  // 68px  (Test for Small ability - Dense)\n        return 6.25;\n    };\n\n    const getButtonLabel = () => {\n        if (phase === 1) return \"üçé\";\n        if (phase === 2) return \"üç™\";\n        if (phase === 3) return \"üç¨\";\n        if (phase === 4) return \"üçá\";\n        return \"\";\n    };\n\n    if (phase === 0) {\n        return (\n            <div style={{\n                position: 'fixed', inset: 0, background: 'var(--bg-color)',\n                display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center',\n                padding: '1.25rem', textAlign: 'center', zIndex: 1200\n            }}>\n                <div style={{ fontSize: '4rem', marginBottom: '1.25rem' }}>üéØ</div>\n                <h1 style={{ marginBottom: '0.625rem', fontSize: '2rem', color: 'var(--text-primary)' }}>Let&apos;s check your touch</h1>\n                <p style={{ color: 'var(--text-secondary)', marginBottom: '1.875rem', maxWidth: '18.75rem', fontSize: '1.1rem', lineHeight: '1.5' }}>\n                    We&apos;ll play a quick game to see which button size works best for you.\n                </p>\n                <button\n                    onClick={() => handleTap(true)}\n                    className=\"primary-button\"\n                    style={{\n                        padding: '1rem 2.5rem', fontSize: '1.25rem', minHeight: '4rem',\n                        display: 'flex', alignItems: 'center', justifyContent: 'center'\n                    }}\n                >\n                    Start Game\n                </button>\n            </div>\n        );\n    }\n\n    return (\n        <div \n            style={{\n                position: 'fixed', inset: 0, background: 'var(--bg-color)',\n                zIndex: 1200, overflow: 'hidden'\n            }}\n            onClick={(e) => {\n                // Missed tap\n                // Only count if they clicked the background, not the button\n                if (e.target === e.currentTarget) {\n                    handleTap(false);\n                }\n            }}\n        >\n            <div style={{ \n                position: 'absolute', top: '1.25rem', width: '100%', \n                textAlign: 'center', color: 'var(--text-primary)', \n                fontSize: '1.25rem', fontWeight: 'bold' \n            }}>\n                Tap the picture! {attempts + 1}/{MAX_ATTEMPTS}\n            </div>\n\n            <button\n                onClick={(e) => {\n                    e.stopPropagation(); // Prevent background click\n                    handleTap(true);\n                }}\n                style={{\n                    position: 'absolute',\n                    left: `${targetPos.x}%`,\n                    top: `${targetPos.y}%`,\n                    transform: 'translate(-50%, -50%)',\n                    width: `${getButtonSize()}rem`,\n                    height: `${getButtonSize()}rem`,\n                    borderRadius: '1.25rem',\n                    background: 'var(--card-bg)',\n                    border: '4px solid var(--primary)',\n                    boxShadow: '0 0.625rem 1.25rem rgba(0,0,0,0.15)',\n                    fontSize: `${getButtonSize() * 0.6}rem`,\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)'\n                }}\n            >\n                {getButtonLabel()}\n            </button>\n        </div>\n    );\n};\n\nexport default TouchCalibration;\n"],"names":["TouchCalibration","onComplete","phase","setPhase","useState","results","setResults","attempts","setAttempts","targetPos","setTargetPos","MAX_ATTEMPTS","getRandomPos","handleTap","success","currentKey","prev","nextAttempt","finalSuccessCount","finishCalibration","size","getButtonSize","getButtonLabel","jsxs","jsx","e"],"mappings":"+GAEA,MAAMA,EAAmB,CAAC,CAAE,WAAAC,KAAiB,CAEzC,KAAM,CAACC,EAAOC,CAAQ,EAAIC,EAAAA,SAAS,CAAC,EAC9B,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,CAAE,GAAI,EAAG,MAAO,EAAG,OAAQ,EAAG,MAAO,EAAG,EACzE,CAACG,EAAUC,CAAW,EAAIJ,EAAAA,SAAS,CAAC,EACpC,CAACK,EAAWC,CAAY,EAAIN,EAAAA,SAAS,CAAE,EAAG,GAAI,EAAG,GAAI,EAErDO,EAAe,EAEfC,EAAe,KAEV,CACH,EAAG,GAAK,KAAK,OAAA,EAAW,GACxB,EAAG,GAAK,KAAK,SAAW,EAAA,GAI1BC,EAAaC,GAAY,CAC3B,GAAIZ,IAAU,EAAG,CACbC,EAAS,CAAC,EACVO,EAAaE,GAAc,EAC3B,MACJ,CAEA,MAAMG,EAAab,IAAU,EAAI,KAAOA,IAAU,EAAI,QAAUA,IAAU,EAAI,SAAW,QAErFY,GACAR,EAAWU,IAAS,CAAE,GAAGA,EAAM,CAACD,CAAU,EAAGC,EAAKD,CAAU,EAAI,CAAA,EAAI,EAGxE,MAAME,EAAcV,EAAW,EAE/B,GAAIU,GAAeN,EAAc,CAC7B,MAAMO,EAAoBb,EAAQU,CAAU,GAAKD,EAAU,EAAI,GAG3DZ,IAAU,EAENgB,GAAqB,EACrBC,EAAkB,WAAW,GAE7BhB,EAAS,CAAC,EACVK,EAAY,CAAC,EACbE,EAAaE,GAAc,GAExBV,IAAU,EAEbgB,GAAqB,EACrBC,EAAkB,KAAK,GAEvBhB,EAAS,CAAC,EACVK,EAAY,CAAC,EACbE,EAAaE,GAAc,GAExBV,IAAU,EAEbgB,GAAqB,EACrBC,EAAkB,UAAU,GAE5BhB,EAAS,CAAC,EACVK,EAAY,CAAC,EACbE,EAAaE,GAAc,GAExBV,IAAU,IAEbgB,GAAqB,EACrBC,EAAkB,OAAO,EAEzBA,EAAkB,QAAQ,EAGtC,MACIX,EAAYS,CAAW,EACvBP,EAAaE,GAAc,CAEnC,EAEMO,EAAqBC,GAAS,CAChC,aAAa,QAAQ,iBAAkBA,CAAI,EAC3CnB,EAAA,CACJ,EAEMoB,EAAgB,IACdnB,IAAU,EAAU,GACpBA,IAAU,EAAU,IACpBA,IAAU,EAAU,IACpBA,IAAU,EAAU,KACjB,KAGLoB,EAAiB,IACfpB,IAAU,EAAU,KACpBA,IAAU,EAAU,KACpBA,IAAU,EAAU,KACpBA,IAAU,EAAU,KACjB,GAGX,OAAIA,IAAU,EAENqB,EAAAA,KAAC,OAAI,MAAO,CACR,SAAU,QAAS,MAAO,EAAG,WAAY,kBACzC,QAAS,OAAQ,cAAe,SAAU,WAAY,SAAU,eAAgB,SAChF,QAAS,UAAW,UAAW,SAAU,OAAQ,IAAA,EAEjD,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,MAAO,CAAE,SAAU,OAAQ,aAAc,SAAA,EAAa,SAAA,IAAA,CAAE,EAC7DA,EAAAA,IAAC,KAAA,CAAG,MAAO,CAAE,aAAc,WAAY,SAAU,OAAQ,MAAO,qBAAA,EAAyB,SAAA,wBAAA,CAA2B,EACpHA,EAAAA,IAAC,IAAA,CAAE,MAAO,CAAE,MAAO,wBAAyB,aAAc,WAAY,SAAU,WAAY,SAAU,SAAU,WAAY,OAAS,SAAA,uEAErI,EACAA,EAAAA,IAAC,SAAA,CACG,QAAS,IAAMX,EAAU,EAAI,EAC7B,UAAU,iBACV,MAAO,CACH,QAAS,cAAe,SAAU,UAAW,UAAW,OACxD,QAAS,OAAQ,WAAY,SAAU,eAAgB,QAAA,EAE9D,SAAA,YAAA,CAAA,CAED,EACJ,EAKJU,EAAAA,KAAC,MAAA,CACG,MAAO,CACH,SAAU,QAAS,MAAO,EAAG,WAAY,kBACzC,OAAQ,KAAM,SAAU,QAAA,EAE5B,QAAUE,GAAM,CAGRA,EAAE,SAAWA,EAAE,eACfZ,EAAU,EAAK,CAEvB,EAEA,SAAA,CAAAU,OAAC,OAAI,MAAO,CACR,SAAU,WAAY,IAAK,UAAW,MAAO,OAC7C,UAAW,SAAU,MAAO,sBAC5B,SAAU,UAAW,WAAY,MAAA,EAClC,SAAA,CAAA,oBACmBhB,EAAW,EAAE,IAAEI,CAAA,EACrC,EAEAa,EAAAA,IAAC,SAAA,CACG,QAAUC,GAAM,CACZA,EAAE,gBAAA,EACFZ,EAAU,EAAI,CAClB,EACA,MAAO,CACH,SAAU,WACV,KAAM,GAAGJ,EAAU,CAAC,IACpB,IAAK,GAAGA,EAAU,CAAC,IACnB,UAAW,wBACX,MAAO,GAAGY,EAAA,CAAe,MACzB,OAAQ,GAAGA,EAAA,CAAe,MAC1B,aAAc,UACd,WAAY,iBACZ,OAAQ,2BACR,UAAW,sCACX,SAAU,GAAGA,IAAkB,EAAG,MAClC,QAAS,OAAQ,WAAY,SAAU,eAAgB,SACvD,OAAQ,UACR,WAAY,4CAAA,EAGf,SAAAC,EAAA,CAAe,CAAA,CACpB,CAAA,CAAA,CAGZ"}